%h3.page-title
  = t('.account_settings')
%p.light
  = t('.you_can_change_your_username')
  - if current_user.ldap_user?
    = t('some_option_are_unavailable_for_ldap', scope: 'profiles.show')
%hr


.account-page
  %fieldset.update-token
    %legend
      = t('.private_token')
    %div
      = form_for @user, url: reset_private_token_profile_path, method: :put do |f|
        .data
          %p
            = t('.your_private_token_is_used_for')
            %br
            = t('.it_can_be_used_for_atom_feeds_or_api')
            %span.cred
              = t('.keep_it_secret')

          %p.cgray
            - if current_user.private_token
              = text_field_tag "token", current_user.private_token, class: "form-control"
              %div
                = f.submit t('general.reset'), data: { confirm: t('general.are_you_sure') }, class: "btn btn-primary btn-build-token"
            - else
              %span= t('.you_dont_have_one_yet')
              = f.submit t('generate', scope: 'shared.project_filter'), class: "btn success btn-build-token"


  - if show_profile_social_tab?
    %fieldset
      %legend= t('.social_accounts')
      .oauth_select_holder.append-bottom-10
        %p= t('.click_on_icon_to_activate_signin')
        - enabled_social_providers.each do |provider|
          %span{class: oauth_active_class(provider) }
            = link_to authbutton(provider, 32), omniauth_authorize_path(User, provider)

  - if show_profile_username_tab?
    %fieldset.update-username
      %legend
        = t('.username')
      = form_for @user, url: update_username_profile_path,  method: :put, remote: true do |f|
        %p
          = t('.changing_your_username_change_all_projects')
        %div
          = f.text_field :username, required: true, class: 'form-control'
          &nbsp;
        .loading-gif.hide
          %p
            %i.icon-spinner.icon-spin
            = t('.saving_new_username')
        %p.light
          = user_url(@user)
        %div
          = f.submit t('.save_username'), class: "btn btn-save"

  - if show_profile_remove_tab?
    %fieldset.remove-account
      %legend
        = t('.remove_account')
      %div
        %p #{t('.deleting_an_account_has_the_effects')}:
        %ul
          %li= t('.all_user_content_will_be_removed')
          - rp = current_user.personal_projects.count
          - unless rp.zero?
            %li= t('.will_be_removed', pluralize: pluralize(rp, t('.personal_project'), t('.personal_projects')))
          - if current_user.solo_owned_groups.present?
            %li
              #{t('.the_following_groups_will_be_abandoned')}:
              %strong #{current_user.solo_owned_groups.map(&:name).join(', ')}
        = link_to t('.delete_account'), user_registration_path, data: { confirm: t('.remove_user_are_you_sure', name: current_user.name) }, method: :delete, class: "btn btn-remove"
